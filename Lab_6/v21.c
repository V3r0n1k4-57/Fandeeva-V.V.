#include <stdio.h>
#include <math.h> // Включаем для использования pow, хотя мы его избегаем, но может пригодиться для сравнения или если X^2 нужно явно.

// Функция для вычисления косинуса через ряд Тейлора
void calculate_cos_approximation(double X, int M) {
    // 1. Проверка входных данных
    if (M <= 0) {
        printf("Ошибка: M должно быть положительным целым числом (M > 0).\n");
        return;
    }

    // 2. Инициализация
    // Первый член ряда (k=0): T_0 = 1
    double current_term = 1.0; 
    double sum = 1.0;
    
    // Вычисляем X^2 один раз, так как он используется в каждом шаге
    double X_squared = X * X;

    printf("\n--- Расчет для X = %f, M = %d ---\n", X, M);
    printf("k=0: Член = %.10f, Сумма = %.10f\n", current_term, sum);
    // 3. Цикл для вычисления оставшихся M-1 членов (k от 1 до M-1)
    // В рекуррентной формуле, если T_k = T_{i-1}, то i пробегает от 1 до M-1.
    // В нашем алгоритме (k - это индекс в формуле T_{k+1} = ... T_k), 
    // мы итерируемся, пока не вычислим M членов.
    
    // Мы уже посчитали 1-й член (k=0). Осталось M-1 итераций.
    for (int k = 0; k < M - 1; k++) {
        // k здесь соответствует индексу предыдущего члена. 
        // Для вычисления следующего члена (индекс k+1):
        // Знаменатель: (2(k+1)) * (2(k+1) - 1) = (2k+2) * (2k+1)
        
        int denominator_factor_1 = 2 * k + 2;
        int denominator_factor_2 = 2 * k + 1;
        
        // Рекуррентное соотношение: T_{k+1} = T_k * (-X^2 / ((2k+2)(2k+1)))
        current_term = current_term * (-X_squared / (double)(denominator_factor_1 * denominator_factor_2));
        
        sum += current_term;
        
        printf("k=%d: Член = %.10f, Сумма = %.10f\n", k + 1, current_term, sum);
    }

    // 4. Вывод результата
    printf("\nИтоговое приближенное значение cos(%.4f) с %d членами: %.12f\n", X, M, sum);
    
    // Для справки: сравнение с библиотечной функцией
    printf("Точное значение cos(%.4f) (из math.h): %.12f\n", X, cos(X));
}


int main() {
    // Ввод данных
    double X;
    int M;

    printf("Введите вещественное число X: ");
    if (scanf("%lf", &X) != 1) {
        printf("Ошибка ввода X.\n");
        return 1;
    }

    printf("Введите целое число M (M > 0): ");
    if (scanf("%d", &M) != 1) {
        printf("Ошибка ввода M.\n");
        return 1;
    }

    // Выполнение расчетов
    calculate_cos_approximation(X, M);

    return 0;
}

